# https://jekyllrb.com/docs/continuous-integration/travis-ci/

# .travis.yml validator: http://lint.travis-ci.org/

# https://docs.travis-ci.com/user/languages/ruby/
language: ruby

sudo: false

rvm:
  - 2.6

env:
  global:
    - NOKOGIRI_USE_SYSTEM_LIBRARIES=true # speeds up installation of html-proofer

before_install:
  - rm Gemfile.lock
  - export GEM_HOME=$PWD/vendor/bundle/ruby/2.1.0
  - gem install bundler

cache: bundler # caching bundler gem packages will speed up build

# https://docs.travis-ci.com/user/notifications/#Configuring-email-notifications
notifications:
  email:
    on_success: never
    on_failure: always

addons:
  apt:
    packages:
    - libcurl4-openssl-dev
    - aspell
    - aspell-en

# https://github.com/gjtorikian/html-proofer
# ignore some sites via url-ignore, they seem to have trouble on travis-ci build
script:
    - bundle exec jekyll build --future
    - bundle exec htmlproofer ./_site --only-4xx --check-favicon --check-html --url-ignore "/vimeo.com/,/researchgate.net/"
    - ./spellcheck.sh
